<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   
    <title>Farmer Details</title>
</head>

<body>
    <div id="farmer-details" class="container-fluid p-0">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <h5 class="card-header bg-primary text-white">Farmer Details</h5>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 text-center">
                                <img id="profilePicture" src="" alt="Profile Picture" style="max-width: 100%;" class="rounded-circle">
                            </div>
                            <div class="col-md-9">
                                <ul class="list-group">
                                    <li class="list-group-item bg-light">
                                        <strong>Farmer's Registered Produce </strong> <br/>
                                        <ul id="produceInfoList"></ul>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong> Current Farmer Registration Status:</strong> <span id="farmerRegStatus"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Farm Name:</strong> <span id="farmName"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>First Name:</strong> <span id="firstName"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Last Name:</strong> <span id="lastName"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Phone Number:</strong> <span id="phoneNumber"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Address:</strong> <span id="address"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Registration Number:</strong> <span id="registrationNumber"></span>
                                    </li>
                                    <li class="list-group-item bg-light">
                                        <strong>Email:</strong> <span id="email"></span>
                                    </li>
                                </ul>
                            </div>
                            <a href="./farmers.html" class="btn btn-secondary">Back</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="../general/basejs.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- <script src="../general/login.js"></script> -->

   
<script>

    const id = localStorage.getItem("id");
    
    function ViewDetails(id) {
        fetch(`${baseUrl}api/Farmer/FarmerProfile/${id}`)
            .then(response => {
                console.log("response", response)
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                // Assuming the returned data is an object with customer attributes
                displayFarmerData(data.data);
            })
            .catch(error => {
                console.error("Error:", error);
                // Display an error message to the user
                displayError();
            });
    
        function displayFarmerData(data) {
            const body = document.querySelector("#farmer-details");
            const template = document.querySelector("#farmer-details-template").content.cloneNode(true);
    
            // Select elements from the template
            const firstName = template.querySelector("#firstName");
            const farmerRegStatus = template.querySelector("#farmerRegStatus");
            const farmName = template.querySelector("#farmName");
            const lastName = template.querySelector("#lastName");
            const phoneNumber = template.querySelector("#phoneNumber");
            const address = template.querySelector("#address");
            const registrationNumber = template.querySelector("#registrationNumber");
            const email = template.querySelector("#email");
            const profilePicture = template.querySelector("#profilePicture");
    
            // Populate elements with data
            const farmerDto = data.farmerDto; // Declare farmerDto
            firstName.textContent = farmerDto.firstName;
            lastName.textContent = farmerDto.lastName;
            phoneNumber.textContent = farmerDto.phoneNumber;
            address.textContent = farmerDto.address;
            registrationNumber.textContent = farmerDto.registrationNumber;
            email.textContent = farmerDto.email;
            farmerRegStatus.textContent = mapFarmerRegStatus(farmerDto.farmerRegStatus);
            farmName.textContent = farmerDto.farmName;
    
            // Select the list element for produce types
            const produceInfoList = template.querySelector("#produceInfoList");
    
            data.produceTypeDto.forEach(produceType => {
                const listItem = document.createElement("li");
                listItem.textContent = `Type Name: ${produceType.typeName}, Produce Name: ${produceType.produceName}, Category: ${produceType.nameOfCategory}`;
                produceInfoList.appendChild(listItem);
            });
    
            // Set the profile picture source
            profilePicture.src = `${baseUrl}Upload/images/${farmerDto.profilePicture}`;
            profilePicture.alt = "Profile Picture";
    
            body.innerHTML = ''; // Clear previous content
            body.appendChild(template);
        }
    
        function displayError() {
            const farmerDetails = document.querySelector("#farmer-details");
            farmerDetails.innerHTML = `<p class="text-danger">An error occurred while fetching farmer data.</p>`;
        }
    }
    
    function mapFarmerRegStatus(status) {
        switch (status) {
            case 1:
                return "Pending";
            case 2:
                return "Declined";
            case 3:
                return "Approved";
            // default:
            //     return "Unknown";
        }
    }
    
    </script>
    
    
</body>

</html>



